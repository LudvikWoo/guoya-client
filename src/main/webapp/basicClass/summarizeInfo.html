<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>summarizeInfo.html</title>

<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
<meta http-equiv="description" content="this is my page">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script type="text/javascript"
	src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="js/jquery.js"></script>
<!--<link rel="stylesheet" type="text/css" href="./styles.css">-->
<style type="text/css">
div {
	border: 0px solid black;
}

table {
	margin-top: 10px;
}

table,th,td {
	border: 0px solid black;
	width: 100%;
}

img {
	height: 400px;
}

.max {
	width: 100%;
	height: auto;
	margin-left: 50px;
	margin-top: 10px;
	margin-right: 10px;
}

.min {
	width: auto;
	height: 200px;
	margin-left: 10px;
	margin-top: 10px;
	margin-right: 10px;
}

.search_name_td {
	width: 8%;
	text-align: right;
}

#submit_summary_div /*悬浮框标签*/ {
	position: fixed; /*浮窗位置*/
	left: 4px;
	top: 0px; /*靠右*/
	background-color: white;
}

#submit_summary_div td /*悬浮框标签*/ {
	border-bottom: 0px solid black
}

#search_condition_div /*悬浮框标签*/ {
	width: 130px;
	position: fixed; /*浮窗位置*/
	right: 10px;
	top: 30%; /*靠右*/
	background-color: white;
	border: 0px solid black
}

#search_condition_div td /*悬浮框标签*/ {
	border-bottom: 0px solid black;
}

#search_condition_div input {
	height: 20px;
	width: 95%;
	border: 1px solid gray;
}

[type=button],[type=reset]{
	background-color:#0099FF;
	color:white;
}
</style>
<script type="text/javascript">
	var publicUrl = "http://192.168.1.45:8083/guoya-server/summaryInfo";
	//var publicUrl="http://127.0.0.1:8083/guoya-server/summaryInfo";
	$(document).ready(function() {
		/*$('#div_imgs_id img').click(function() {
			$(this).toggleClass('min');
			$(this).toggleClass('max');
		});*/
		$("#div_imgs_id").on("click", "img", function() {
			$(this).toggleClass('min');
			$(this).toggleClass('max');
		});
	});
	function uploadFile() {
		//获取学号
		var sno = document.getElementById("sno").value;
		//var snoSelect = document.getElementById("sno");
		//var sno = snoSelect.options[snoSelect.selectedIndex].value;
		//alert(sno);
		var summaryDate = document.getElementById("summaryDate").value;
		//alert(summaryDate);
		var r = confirm("确认提交？");
		if (r == true) {
			var userfile = document.getElementById("postFild");
			var fd = new FormData();
			fd.append("userfile", userfile.files[0]);//文件追到到FormData
			fd.append("sno", sno);
			fd.append("summaryDate", summaryDate);

			var xhr = new XMLHttpRequest();
			xhr.open("POST", publicUrl + "?method=uploadSumarizePic&sno=" + sno
					+ "&summaryDate=" + summaryDate);
			xhr.send(fd);
			xhr.onreadystatechange = function() {
				if (xhr.readyState == 4 && xhr.status == 200) {
					var result = xhr.responseText;
					//alert(result);
					displayImgs(result);
				}
			};
		}
	}

	function displayImgs(data) {
		/*var data = "{                                                                                              "
				+ "  \"summaries\": {                                                                             "
				+ "    \"summaryDate\": {                                                                         "
				+ "      \"date\": \"2018-03-17\",                                                                "
				+ "      \"student\": [                                                                           "
				+ "        {                                                                                      "
				+ "          \"sno\": \"s0401\",                                                                  "
				+ "          \"sname\": \"陈海东\",                                                               "
				+ "          \"imgPath\": \"/guoya-client/basicClass/images/summarizes/s0401_2018-03-17_c01.jpg\" "
				+ "        },                                                                                     "
				+ "        {                                                                                      "
				+ "          \"sno\": \"s0203\",                                                                  "
				+ "          \"sname\": \"张兴\",                                                                 "
				+ "          \"imgPath\": \"/guoya-client/basicClass/images/summarizes/s0203_2018-03-14_c05.jpg\" "
				+ "        },                                                                                      "
				+ "        {                                                                                      "
				+ "          \"sno\": \"s0203\",                                                                  "
				+ "          \"sname\": \"张兴\",                                                                 "
				+ "          \"imgPath\": \"/guoya-client/basicClass/images/summarizes/s0203_2018-03-14_c05.jpg\" "
				+ "        },                                                                                      "
				+ "        {                                                                                      "
				+ "          \"sno\": \"s0203\",                                                                  "
				+ "          \"sname\": \"张兴\",                                                                 "
				+ "          \"imgPath\": \"/guoya-client/basicClass/images/summarizes/s0203_2018-03-14_c05.jpg\" "
				+ "        }                                                                                      "
				+ "      ]                                                                                        "
				+ "    }                                                                                          "
				+ "  }                                                                                            "
				+ "}                                                                                              ";
		 */
		var html = "";
		var students = JSON.parse(data).summaries.summaryDate.student;
		for ( var i in students) {
			//alert(urls[i]);
			var student = students[i];
			html = html
					+ "		<div style=\"float: left;\">                                       "
					+ "			<div style=\"text-align:center\">                              "
					+ "				<img src=\""+student.imgPath+"\" class=\"min\">     "
					+ "			</div>                                                         "
					+ "			<div style=\"text-align:center\">"
					+ student.sno
					+ " "
					+ student.sname
					+ "</div>                    "
					+ "			</table>                                                       "
					+ "		</div>                                                             ";
		}
		var div = document.getElementById("div_imgs_id");
		//alert(html);
		div.innerHTML = html;
	}

	/*
	 */
	window.onload = function() {
		initPage();
	}
	function initPage() {
		var date = new Date();
		var seperator1 = "-";
		var year = date.getFullYear();
		var month = date.getMonth() + 1;
		var strDate = date.getDate();
		if (month >= 1 && month <= 9) {
			month = "0" + month;
		}
		if (strDate >= 0 && strDate <= 9) {
			strDate = "0" + strDate;
		}
		var currentdate = year + seperator1 + month + seperator1 + strDate;
		var xhr = new XMLHttpRequest();
		xhr.open("POST", publicUrl + "?method=querySumariseByDate&summaryDate="
				+ currentdate);
		xhr.send();
		xhr.onreadystatechange = function() {
			if (xhr.readyState == 4 && xhr.status == 200) {
				var result = xhr.responseText;
				//alert(result);
				displayImgs(result);
			}
		};
	}
</script>
</head>

<body>

	<div id="search_condition_div">
		<form>
		<table>
			<tr>
				<td>姓名：</td>
			</tr>
			<tr>
				<td><select style="width:95%" id="sno">
						<option value="-1" selected="selected">——请选择——</option>
						<option value="s0101">S0101_陈琳</option>
						<option value="s0102">S0102_唐文</option>
						<option value="s0103">S0103_丁国梁</option>
						<option value="s0201">S0201_陈倪</option>
						<option value="s0202">S0202_吴浪</option>
						<option value="s0203">S0203_张兴</option>
						<option value="s0301">S0301_郑地</option>
						<option value="s0302">S0302_胡小芬</option>
						<option value="s0303">S0303_张聪</option>
						<option value="s0401">S0401_陈海东</option>
						<option value="s0402">S0402_金兆斌</option>
						<option value="s0403">S0403_徐英</option>
						<option value="s0501">S0501_王静</option>
						<option value="s0502">S0502_刘广洲</option>
						<option value="s0503">S0503_王均</option>
						<option value="s0601">S0601_肖飞飞</option>
						<option value="s0602">S0602_刘樊</option>
						<option value="s0603">S0603_朱赛健</option>
						<option value="s0701">S0701_庄昌宁</option>
						<option value="s0702">S0702_魏聿明</option>
						<option value="s0703">S0703_李静</option>
						<option value="s0801">S0801_陈超</option>
						<option value="s0802">S0802_周盛明</option>
						<option value="s0803">S0803_蒋方妍</option>
						<option value="s0901">S0901_杨志康</option>
				</select></td>
			</tr>
			<tr>
				<td>日期：</td>
			</tr>
			<tr>
				<td><input type="date"></td>
			</tr>
			<tr>
				<td>导师：</td>
			</tr>
			<tr>
				<td><select style="width:95%" size="1">
						<option>---请选择---</option>
						<option>李晓阳</option>
						<option>戈维维</option>
						<option>马超</option>
						<option>闫松林</option>
						<option>李苏云</option>
						<option>戴全明</option>
						<option>周启明</option>
						<option>曾春苗</option>
					</select></td>
			</tr>
			<tr>
				<td>小组：</td>
			</tr>
			<tr>
				<td><select style="width:95%" size="1">
						<option>---请选择---</option>
						<option>第1组</option>
						<option>第2组</option>
						<option>第3组</option>
						<option>第4组</option>
						<option>第5组</option>
						<option>第6组</option>
						<option>第7组</option>
						<option>第8组</option>
						<option>第9组</option>
					</select></td>
			</tr>
			<tr>
				<td>
					<input type="button" value="查询" style="width:40%;margin-left:5px;margin-top:15px;margin-bottom:10px">
					<input type="reset" value="重置" style="width:40%;margin-left:10px;margin-top:15px;margin-bottom:10px">
				</td>
			</tr>
		</table>
		</form>
	</div>
	<div id="submit_summary_div">
		<table>
			<tr>
				<td class="search_name_td">姓名：</td>
				<td style="width:20%;"><select style="width:80%" id="sno">
						<option value="-1" selected="selected">——请选择——</option>
						<option value="s0101">S0101_陈琳</option>
						<option value="s0102">S0102_唐文</option>
						<option value="s0103">S0103_丁国梁</option>
						<option value="s0201">S0201_陈倪</option>
						<option value="s0202">S0202_吴浪</option>
						<option value="s0203">S0203_张兴</option>
						<option value="s0301">S0301_郑地</option>
						<option value="s0302">S0302_胡小芬</option>
						<option value="s0303">S0303_张聪</option>
						<option value="s0401">S0401_陈海东</option>
						<option value="s0402">S0402_金兆斌</option>
						<option value="s0403">S0403_徐英</option>
						<option value="s0501">S0501_王静</option>
						<option value="s0502">S0502_刘广洲</option>
						<option value="s0503">S0503_王均</option>
						<option value="s0601">S0601_肖飞飞</option>
						<option value="s0602">S0602_刘樊</option>
						<option value="s0603">S0603_朱赛健</option>
						<option value="s0701">S0701_庄昌宁</option>
						<option value="s0702">S0702_魏聿明</option>
						<option value="s0703">S0703_李静</option>
						<option value="s0801">S0801_陈超</option>
						<option value="s0802">S0802_周盛明</option>
						<option value="s0803">S0803_蒋方妍</option>
						<option value="s0901">S0901_杨志康</option>
				</select></td>

				<td class="search_name_td">拍照：</td>
				<td style="width:20%;"><input style="width:80%" type="file"
					id="postFild" name="userfile" /></td>
				<td class="search_name_td">日期：</td>
				<td style="width:20%;"><input type="date" name="summaryDate"
					id="summaryDate"></td>

				<td style="text-align:center;"><input type="button"
					value="上传总结" onclick="uploadFile();" /></td>
			</tr>
		</table>
		<hr>
	</div>
	<div id="div_imgs_id" style="width:100%;margin-top:55px;">
		<!-- <div style="float: left;">
			<div style="text-align:center">
				<img src="images/summarizes/test.jpg" class='min'>
			</div>
			<div style="text-align:center">姓名</div>
			</table>
		</div>
		<div style="float: left;">
			<div style="text-align:center">
				<img src="images/summarizes/test1.jpg" class='min'>
			</div>
			<div style="text-align:center">姓名</div>
			</table>
		</div>
		<div style="float: left;">
			<div style="text-align:center">
				<img src="images/summarizes/test2.jpg" class='min'>
			</div>
			<div style="text-align:center">姓名</div>
			</table>
		</div>
		 -->
	</div>
</body>
</html>
